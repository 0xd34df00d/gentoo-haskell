--- gitit-0.8.1-orig/gitit.cabal	2011-09-04 07:46:18.000000000 +1000
+++ gitit-0.8.1-happstack-server-6.4/gitit.cabal	2011-12-14 22:38:49.005714043 +1100
@@ -144,14 +144,14 @@
                      filestore >= 0.4.0.2 && < 0.5,
                      zlib >= 0.5 && < 0.6,
                      url >= 2.1 && < 2.2,
-                     happstack-server >= 6.0 && < 6.3,
+                     happstack-server >= 6.0 && < 6.5,
                      happstack-util >= 6.0 && < 6.2,
                      xml >= 1.3.5,
                      hslogger >= 1 && < 1.2,
                      ConfigFile >= 1 && < 1.2,
                      feed >= 0.3.6 && < 0.4,
                      xss-sanitize >= 0.3 && < 0.4,
-                     json >= 0.4 && < 0.5
+                     json >= 0.4 && < 0.6
   if impl(ghc >= 6.10)
     build-depends:   base >= 4, syb
   if impl(ghc >= 7.0.3)
--- gitit-0.8.1-orig/Network/Gitit/Types.hs	2011-09-04 07:46:18.000000000 +1000
+++ gitit-0.8.1-happstack-server-6.4/Network/Gitit/Types.hs	2011-12-14 22:33:56.761423406 +1100
@@ -307,7 +307,7 @@
          pa <- look' "patterns"       `mplus` return ""
          gt <- look' "gotopage"       `mplus` return ""
          ft <- look' "filetodelete"   `mplus` return ""
-         me <- lookRead "messages"   `mplus` return []
+         me <- lookReads "messages"   `mplus` return []
          fm <- liftM Just (look' "from") `mplus` return Nothing
          to <- liftM Just (look' "to")   `mplus` return Nothing
          et <- liftM (Just . filter (/='\r')) (look' "editedText")
