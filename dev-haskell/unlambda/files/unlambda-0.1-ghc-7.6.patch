--- unlambda-0.1-orig/Main.hs	2008-06-09 08:40:02.000000000 +1000
+++ unlambda-0.1/Main.hs	2012-09-22 15:26:41.010230478 +1000
@@ -1,9 +1,13 @@
-{-# LANGUAGE PatternGuards #-}
+{-# LANGUAGE CPP, PatternGuards, ScopedTypeVariables #-}
 
 module Main where
 
 -- A time- and output-limited unlambda
 
+#if !MIN_VERSION_base(4,6,0)
+import Prelude hiding(catch)
+#endif
+import Control.Exception (catch, IOException)
 import System.Posix.Resource
 import Data.Char
 import System.IO
@@ -24,7 +28,7 @@
 --
 parse :: Handle -> IO Exp
 parse h = do
-  c <- catch (hGetChar h) (\_ -> error "Parse error at end of file")
+  c <- catch (hGetChar h) (\(_ :: IOException) -> error "Parse error at end of file")
   case toLower c of
     d | d `elem` " \t\n"  -> parse h
     '`' -> do e1 <- parse h
--- unlambda-0.1-orig/Language/Unlambda.hs	2008-06-09 08:40:02.000000000 +1000
+++ unlambda-0.1/Language/Unlambda.hs	2012-09-22 15:25:48.475007023 +1000
@@ -1,3 +1,4 @@
+{-# LANGUAGE CPP, ScopedTypeVariables #-}
 {-# OPTIONS -fglasgow-exts #-}
 
 {-
@@ -26,6 +27,11 @@
 
 module Language.Unlambda where
 
+#if !MIN_VERSION_base(4,6,0)
+import Prelude hiding(catch)
+#endif
+import Control.Exception (catch, IOException)
+
 ------------------------------------------------------------------------
 -- Abstract syntax
 
@@ -132,7 +138,7 @@
 apply (Dot c) x  = step >> io (putChar c) >> return x
 apply E x        = exit x
 apply At f = do
-  dat <- io $ catch (getChar >>= return . Just) (const $ return Nothing)
+  dat <- io $ catch (getChar >>= return . Just) (\(_ :: IOException) -> return Nothing)
   setCurrentChar dat
   apply f (case dat of Nothing -> V ; Just _  -> I)
 apply (Ques c) f = do
